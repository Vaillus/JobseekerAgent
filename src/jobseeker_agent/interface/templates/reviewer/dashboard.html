<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Job Review Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/reviewer.css') }}">
</head>
<body>
    <div id="sidebar">
        <div class="sidebar-tabs">
            <button class="sidebar-tab-btn active" data-tab="jobs">Jobs</button>
            <button class="sidebar-tab-btn" data-tab="scraper">Scraper</button>
            <button class="sidebar-tab-btn" data-tab="review">Review</button>
        </div>
        <div class="sidebar-content">
            <div id="jobs-tab" class="sidebar-tab-content active">
                <h2>Jobs To Process</h2>
                <div id="job-list">
            {% for job in sidebar_jobs %}
            <div class="job-item" data-job-id="{{ job.id }}">
                <h4>{{ job.title or 'N/A' }} (Score: {{ job.score if job.score is not none else 'N/A' }})</h4>
                <p>{{ job.company or 'N/A' }} - {{ job.location or 'N/A' }}</p>
            </div>
            {% endfor %}
                </div>
            </div>
            <div id="scraper-tab" class="sidebar-tab-content">
                <h2>Scrape Jobs</h2>
                <div class="control-group">
                    <label for="time-horizon-days">Number of days:</label>
                    <input type="number" id="time-horizon-days" class="control-input" value="1" min="1" max="365">
                </div>

                <div id="destinations-section" class="control-group">
                    <h3>Destinations</h3>
                    <div id="destinations-list"></div>
                    <div id="destination-inline-form" style="display:none; margin-top:8px;">
                        <input type="text" id="new-destination-location" class="control-input" placeholder="Location (e.g., Paris, France)">
                        <select id="new-destination-remote-type" class="control-select">
                            <option value="any">any</option>
                            <option value="remote">remote</option>
                            <option value="hybrid">hybrid</option>
                            <option value="on_site">on_site</option>
                        </select>
                        <button id="confirm-add-destination" class="control-btn">Add</button>
                        <button id="cancel-add-destination" class="control-btn">Cancel</button>
                    </div>
                    <button id="add-destination-btn" class="control-btn">+ Add Destination</button>
                </div>

                <button id="scrape-btn" class="control-btn scrape-btn">Launch Scraping</button>
                <div id="scrape-status" class="status-display"></div>
                
                <h2 style="margin-top: 2em;">Update Job Statuses</h2>
                <button id="update-status-btn" class="control-btn update-status-btn">Check Status Changes</button>
                <div id="update-status-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div id="update-status-progress-bar" class="progress-bar-fill"></div>
                    </div>
                    <div id="update-status-progress-text" class="progress-text">0 / 0</div>
                </div>
                <div id="update-status-display" class="status-display"></div>
            </div>
            <div id="review-tab" class="sidebar-tab-content">
                <h2>Review Jobs</h2>
                <div class="control-group">
                    <label for="review-count">Number of reviews:</label>
                    <input type="number" id="review-count" class="control-input" value="10" min="1" max="100">
                </div>
                <button id="review-btn" class="control-btn review-btn">Launch Review</button>
                <div id="review-count-info" style="margin-top: 8px; font-size: 0.9em; color: #666;">
                    Ã€ review: {{ review_count_info.unreviewed_count }} / {{ review_count_info.total_open_count }} ({{ review_count_info.percentage }}%)
                </div>
                <div id="review-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div id="review-progress-bar" class="progress-bar-fill"></div>
                    </div>
                    <div id="review-progress-text" class="progress-text">0 / 0</div>
                </div>
                <div id="review-status" class="status-display"></div>
            </div>
        </div>
    </div>
    <div id="content">
        <div id="placeholder">
            <h1>Welcome to the Job Review Dashboard</h1>
            <p>Select a job from the list on the left to see its details.</p>
        </div>
        <div id="job-details" style="display: none; height: 100%; flex-direction: column;"></div>
    </div>

    <script id="jobs-data" type="application/json">{{ all_jobs | tojson }}</script>
    <script>
        const jobsData = JSON.parse(document.getElementById('jobs-data').textContent);
    </script>
    <script src="{{ url_for('static', filename='js/reviewer.js') }}"></script>
</body>
</html>
